<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="这里要写啥我不是很清楚"><title>centos7安装gitlab8.9 | 那年八月</title><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/3.0.3/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css"><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><script type="text/javascript" src="//cdn.bootcss.com/jquery/2.2.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">centos7安装gitlab8.9</h1><a id="logo" href="/.">那年八月</a><p class="description">奔赴一座城，拥抱一个人 →_→</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa myfa fa-home"></i>首页</a><a href="/archives/"><i class="fa myfa fa-archive"></i>归档</a><a href="/about/"><i class="fa myfa fa-user"></i>关于</a><a href="/guestbook/"><i class="fa myfa fa-comments"></i>留言</a><a href="/atom.xml"><i class="fa myfa fa-rss"></i>订阅</a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">centos7安装gitlab8.9</h1><div class="post-meta">Sep 9, 2016<span> | </span><span class="category"><a href="/categories/toolkit/">toolkit</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><a data-thread-key="2016/09/09/toolkit/gitlab.html" href="/2016/09/09/toolkit/gitlab.html#ds-thread" class="ds-thread-count"></a><div class="clear"><div id="toc" class="toc-article"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#安装和添加基础工具"><span class="toc-number">1.</span> <span class="toc-text">安装和添加基础工具</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#安装Ruby和Go"><span class="toc-number">2.</span> <span class="toc-text">安装Ruby和Go</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#系统用户"><span class="toc-number">3.</span> <span class="toc-text">系统用户</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#数据库"><span class="toc-number">4.</span> <span class="toc-text">数据库</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Redis"><span class="toc-number">5.</span> <span class="toc-text">Redis</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#安装GitLab"><span class="toc-number">6.</span> <span class="toc-text">安装GitLab</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#配置web服务器"><span class="toc-number">7.</span> <span class="toc-text">配置web服务器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#配置防火墙"><span class="toc-number">8.</span> <span class="toc-text">配置防火墙</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#最后检查"><span class="toc-number">9.</span> <span class="toc-text">最后检查</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Gitlab-备份"><span class="toc-number">10.</span> <span class="toc-text">Gitlab 备份</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#忘记管理员密码"><span class="toc-number">11.</span> <span class="toc-text">忘记管理员密码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#FAQ"><span class="toc-number">12.</span> <span class="toc-text">FAQ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#参考文档"><span class="toc-number">13.</span> <span class="toc-text">参考文档</span></a></li></ol></div></div><div class="post-content"><p>内部需要搭建一个源码管理控制环境，选择开源的gitlab，环境为centos7。这个平台类似于github，使用起来非常方便。
现在将搭建的步骤记录下来，因为官网上面提供的是ubuntu的流程。</p>
<p>全部命令都是在 root 用户下执行</p>
<p>安装操作系统 (CentOS 7 Minimal)，先配置好网卡和DNS，保证网络没问题。<a id="more"></a></p>
<h2 id="安装和添加基础工具"><a href="#安装和添加基础工具" class="headerlink" title="安装和添加基础工具"></a>安装和添加基础工具</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install wget</span><br></pre></td></tr></table></figure>
<p>安装EPEL源
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yum install epel-release</span><br><span class="line">wget -O /etc/pki/rpm-gpg/RPM-GPG-KEY-EPEL-6 https://www.fedoraproject.org/static/0608B895.txt</span><br><span class="line">rpm --import /etc/pki/rpm-gpg/RPM-GPG-KEY-EPEL-6</span><br></pre></td></tr></table></figure></p>
<p>添加RemiRPM仓库
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget -O /etc/pki/rpm-gpg/RPM-GPG-KEY-remi http://rpms.famillecollet.com/RPM-GPG-KEY-remi</span><br><span class="line">rpm --import /etc/pki/rpm-gpg/RPM-GPG-KEY-remi</span><br></pre></td></tr></table></figure></p>
<p>确认是否添加成功
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rpm -qa gpg*</span><br><span class="line"># 查看输出是否包含</span><br><span class="line"># gpg-pubkey-00f97f56-467e318a</span><br></pre></td></tr></table></figure></p>
<p>然后安装，这样就可以添加remi-safe仓库了
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -Uvh http://rpms.famillecollet.com/enterprise/remi-release-7.rpm</span><br></pre></td></tr></table></figure></p>
<p>查看是否添加进去了
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum repolist</span><br></pre></td></tr></table></figure></p>
<p>如果能看到输出，那么使用
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum -y install yum-utils</span><br><span class="line">yum-config-manager --enable epel --enable PUIAS_6_computational</span><br></pre></td></tr></table></figure></p>
<p>最后，更新源缓存
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum clean all &amp;&amp; yum makecache</span><br></pre></td></tr></table></figure></p>
<p>安装必要的工具
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yum -y update</span><br><span class="line">yum -y groupinstall <span class="string">'Development Tools'</span></span><br><span class="line">yum -y install readline readline-devel ncurses-devel gdbm-devel glibc-devel tcl-devel openssl-devel curl-devel expat-devel db4-devel byacc sqlite-devel libyaml libyaml-devel libffi libffi-devel libxml2 libxml2-devel libxslt libxslt-devel libicu libicu-devel system-config-firewall-tui redis sudo wget crontabs logwatch logrotate perl-Time-HiRes git cmake libcom_err-devel.i686 libcom_err-devel.x86_64 ntp nodejs python-docutils</span><br></pre></td></tr></table></figure></p>
<p>gitlab 8.0 之后的版本需要依赖 nodejs，不然安装 gitlab-shell 的时候会出现没有javascript runtime</p>
<p>安装vim
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum -y install vim-enhanced</span><br><span class="line">update-alternatives --set editor /usr/bin/vim.basic</span><br></pre></td></tr></table></figure></p>
<p>设置NTP时间同步
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># 删除当前默认时区</span><br><span class="line">rm -rf /etc/localtime</span><br><span class="line"># 复制替换默认时区为上海</span><br><span class="line">ln -s /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</span><br><span class="line">yum install -y ntp        # 安装时间同步服务（组件）</span><br><span class="line">ntpdate us.pool.ntp.org   # 设置同步服务器</span><br><span class="line">date                      # 查看当前时间</span><br></pre></td></tr></table></figure></p>
<p>配置默认编辑器
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ln <span class="_">-s</span> /usr/bin/vim /usr/bin/editor</span><br></pre></td></tr></table></figure></p>
<p>从源代码安装 Git
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum install -y zlib-devel perl-CPAN gettext curl-devel expat-devel gettext-devel openssl-devel</span><br><span class="line">yum -y remove git</span><br></pre></td></tr></table></figure></p>
<p>下载解压：
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mkdir /tmp/git &amp;&amp; <span class="built_in">cd</span> /tmp/git</span><br><span class="line">curl --progress https://www.kernel.org/pub/software/scm/git/git-2.8.4.tar.gz | tar xz</span><br><span class="line"><span class="built_in">cd</span> git-2.8.4/</span><br><span class="line">./configure</span><br><span class="line">make</span><br><span class="line">make prefix=/usr/<span class="built_in">local</span> install</span><br></pre></td></tr></table></figure></p>
<p>将git加入到PATH中
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">which git</span><br><span class="line">vi /etc/profile</span><br><span class="line"># 最后 export PATH=$PATH:/usr/local/bin/git</span><br><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure></p>
<p>Note: 编辑config/gitlab.yml (step 6), bin_path改成/usr/local/bin/git.</p>
<h2 id="安装Ruby和Go"><a href="#安装Ruby和Go" class="headerlink" title="安装Ruby和Go"></a>安装Ruby和Go</h2><p>GitLab 需要 2.1 以上版本的 Ruby，但是当前不兼容 2.2 和 2.3，先删除旧的
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum remove -y ruby</span><br></pre></td></tr></table></figure></p>
<p>如果没有安装ruby，上述删除的步骤可以跳过</p>
<p>下载安装
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mkdir /tmp/ruby &amp;&amp; cd /tmp/ruby</span><br><span class="line">curl --progress ftp://ftp.ruby-lang.org/pub/ruby/2.1/ruby-2.1.8.tar.gz | tar xz</span><br><span class="line">tar -xzf ruby-2.1.8.tar.gz</span><br><span class="line">cd ruby-2.1.8</span><br><span class="line">./configure --disable-install-rdoc</span><br><span class="line">make</span><br><span class="line">make prefix=/usr/local install</span><br></pre></td></tr></table></figure></p>
<p>安装Bundler Gem:
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">gem sources --remove https://rubygems.org/</span><br><span class="line">gem sources <span class="_">-a</span> https://ruby.taobao.org/</span><br><span class="line">gem sources <span class="_">-l</span></span><br><span class="line">gem install bundler --no-doc</span><br></pre></td></tr></table></figure></p>
<p>同样将<code>which ruby</code>加入到PATH中，和前面git类似
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">which ruby</span><br><span class="line"># /usr/local/bin/ruby</span><br><span class="line">ruby -v</span><br></pre></td></tr></table></figure></p>
<p><em>安装 go （gitlab 8.0 以后的版本需要go语言的支持）</em>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mkdir /tmp/go &amp;&amp; <span class="built_in">cd</span> /tmp/go</span><br><span class="line">URL=<span class="string">'https://storage.googleapis.com/golang/'</span> &amp;&amp; wget -c `curl <span class="_">-s</span> <span class="variable">$URL</span>|xmllint --format - |awk -PF<span class="string">'[&gt;&lt;]'</span> <span class="string">'&#123;if ($3~/linux/ &amp;&amp; $3!~/(beta|rc)[0-9]+|armv6l|386/)a=$3&#125;END&#123;print "'</span><span class="variable">$URL</span><span class="string">'"a&#125;'</span>`</span><br><span class="line"><span class="comment"># 上面下载的是个md5验证，可以自己先wget压缩包后手动解压缩安装</span></span><br><span class="line">tar xf go*.linux-amd64.tar.gz -C /usr/<span class="built_in">local</span>/</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"PATH=/usr/local/go/bin:\$PATH"</span> &gt;/etc/profile.d/go.sh</span><br><span class="line">. /etc/profile.d/go.sh</span><br><span class="line">go version</span><br></pre></td></tr></table></figure></p>
<h2 id="系统用户"><a href="#系统用户" class="headerlink" title="系统用户"></a>系统用户</h2><p>为gitlab创建一个linux系统用户git
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">adduser --system --shell /bin/bash --comment <span class="string">'GitLab'</span> --create-home --home-dir /home/git/ git</span><br><span class="line">visudo</span><br><span class="line"><span class="comment"># Defaults    secure_path = /sbin:/bin:/usr/sbin:/usr/bin</span></span><br><span class="line"><span class="comment"># 改为</span></span><br><span class="line"><span class="comment"># Defaults    secure_path = /sbin:/bin:/usr/sbin:/usr/bin:/usr/local/bin</span></span><br></pre></td></tr></table></figure></p>
<h2 id="数据库"><a href="#数据库" class="headerlink" title="数据库"></a>数据库</h2><p>CentOS 7 版本将 MySQL 数据库软件从默认的程序列表中移除，用 Mariadb 代替了
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yum install -y mariadb mariadb-server mariadb-devel</span><br><span class="line">systemctl <span class="built_in">enable</span> mariadb  <span class="comment">#设置开机启动</span></span><br><span class="line">systemctl start mariadb <span class="comment">#启动MariaDB</span></span><br></pre></td></tr></table></figure></p>
<p>mariadb数据库的相关命令是：
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">systemctl start mariadb  <span class="comment">#启动MariaDB</span></span><br><span class="line">systemctl stop mariadb  <span class="comment">#停止MariaDB</span></span><br><span class="line">systemctl restart mariadb  <span class="comment">#重启MariaDB</span></span><br><span class="line">systemctl <span class="built_in">enable</span> mariadb  <span class="comment">#设置开机启动</span></span><br></pre></td></tr></table></figure></p>
<p>确保你的版本是5.5.14 或以上
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql --version</span><br></pre></td></tr></table></figure></p>
<p>设置数据库 root 用户密码，并设置相关的安全配置
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql_secure_installation</span><br></pre></td></tr></table></figure></p>
<p>因为是刚安装完数据库，因此没有 root 账户的密码，按回车后，会开始让设置密码。
设置完密码后，会问是否删除匿名用户（不需要密码就能登录），选择 y</p>
<p>如果失败了，就使用另外方法
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">stop the mysql daemon.</span><br><span class="line">mysqld_safe --skip-grant-tables</span><br><span class="line">mysql --user=root mysql</span><br><span class="line">update user <span class="built_in">set</span> Password=PASSWORD(<span class="string">'new-password'</span>) <span class="built_in">where</span> user=<span class="string">'root'</span>;</span><br><span class="line">flush privileges;</span><br><span class="line">restart mysql</span><br></pre></td></tr></table></figure></p>
<p>然后mysql -u root -p登陆，使用刚刚的密码，为gitlab创建一个数据库用户git：
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">CREATE USER <span class="string">'git'</span>@<span class="string">'localhost'</span> IDENTIFIED BY <span class="string">'git'</span>;</span><br><span class="line">SET storage_engine=INNODB;</span><br><span class="line"><span class="comment"># 创建生成环境数据库</span></span><br><span class="line">CREATE DATABASE IF NOT EXISTS `gitlabhq_production` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`;</span><br><span class="line"><span class="comment"># 授权</span></span><br><span class="line">GRANT SELECT, LOCK TABLES, INSERT, UPDATE, DELETE, CREATE, DROP, INDEX, ALTER ON `gitlabhq_production`.* TO <span class="string">'git'</span>@<span class="string">'localhost'</span>;</span><br><span class="line">\q</span><br><span class="line"><span class="comment"># 试着连连</span></span><br><span class="line">sudo -u git -H mysql -u git -p -D gitlabhq_production</span><br><span class="line">\q</span><br></pre></td></tr></table></figure></p>
<p>配置 MySQL max_allowed_packet 的大小，避免POST太大的内容导致出现 500 错误，
例如 GitLab 发出 MergeRequest 的时候返回 500 错误。vim /etc/my.cnf，
在 mysqld 中添加 max_allowed_packet，调整值，加大为一个合适的数字即可。
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[mysqld]</span><br><span class="line">max_allowed_packet=512M</span><br></pre></td></tr></table></figure></p>
<p>然后重启：systemctl restart mariadb</p>
<h2 id="Redis"><a href="#Redis" class="headerlink" title="Redis"></a>Redis</h2><p>开机就启动redis
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chkconfig redis on</span><br></pre></td></tr></table></figure></p>
<p>配置socket
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cp /etc/redis.conf /etc/redis.conf.orig</span><br><span class="line"><span class="comment"># 禁止redis监听tcp请求，port设置成0</span></span><br><span class="line">sed <span class="string">'s/^port .*/port 0/'</span> /etc/redis.conf.orig | sudo tee /etc/redis.conf</span><br><span class="line"><span class="built_in">echo</span> <span class="string">'unixsocket /var/run/redis/redis.sock'</span> | sudo tee <span class="_">-a</span> /etc/redis.conf</span><br><span class="line"><span class="built_in">echo</span> <span class="_">-e</span> <span class="string">'unixsocketperm 0775'</span> | sudo tee <span class="_">-a</span> /etc/redis.conf</span><br><span class="line">service redis restart</span><br><span class="line">usermod <span class="_">-a</span>G redis git</span><br></pre></td></tr></table></figure></p>
<h2 id="安装GitLab"><a href="#安装GitLab" class="headerlink" title="安装GitLab"></a>安装GitLab</h2><p>我们把gitlab安装到git用户的home目录
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /home/git</span><br><span class="line"><span class="comment"># 先切换到git账户</span></span><br><span class="line">su - git</span><br><span class="line"><span class="comment"># 再clone代码</span></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/gitlabhq/gitlabhq.git -b 8-8-stable gitlab</span><br><span class="line"><span class="comment"># Go to GitLab installation folder</span></span><br><span class="line"><span class="built_in">cd</span> /home/git/gitlab</span><br><span class="line">vi /etc/sudoers</span><br><span class="line"><span class="comment"># 最后添加：git ALL=(ALL)  NOPASSWD: ALL</span></span><br><span class="line">sudo -u git -H cp config/gitlab.yml.example config/gitlab.yml</span><br><span class="line">sudo -u git -H vim config/gitlab.yml</span><br></pre></td></tr></table></figure></p>
<p>配置如下信息
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">host: 192.168.217.161</span><br><span class="line">port: 8008</span><br><span class="line">email_from: xiongneng@winhong.com</span><br><span class="line">default_theme: 1</span><br></pre></td></tr></table></figure></p>
<p>确保 GitLab 可以写 log/ and tmp/ 目录，配置其他文件夹权限
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">chown -R git log/</span><br><span class="line">chown -R git tmp/</span><br><span class="line">chmod -R u+rwX log/</span><br><span class="line">chmod -R u+rwX tmp/</span><br><span class="line">sudo -u git -H mkdir /home/git/gitlab-satellites</span><br><span class="line">chmod u+rwx,g=rx,o-rwx /home/git/gitlab-satellites</span><br><span class="line">chmod -R u+rwX tmp/pids/</span><br><span class="line">chmod -R u+rwX tmp/sockets/</span><br><span class="line">sudo -u git mkdir /home/git/gitlab/public/uploads</span><br><span class="line">chmod -R u+rwX  /home/git/gitlab/public/uploads</span><br></pre></td></tr></table></figure></p>
<p>Unicorn 配置：
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sudo -u git -H cp config/unicorn.rb.example config/unicorn.rb</span><br><span class="line">nproc  <span class="comment"># 看看有几个核心</span></span><br><span class="line"><span class="comment"># Enable cluster mode if you expect to have a high load instance</span></span><br><span class="line"><span class="comment"># Ex. change amount of workers to 3 for 2GB RAM server</span></span><br><span class="line"><span class="comment"># Set the number of workers to at least the number of cores</span></span><br><span class="line"><span class="comment"># listen "0.0.0.0:8008", :tcp_nopush =&gt; true</span></span><br><span class="line">sudo -u git -H vim config/unicorn.rb</span><br></pre></td></tr></table></figure></p>
<p>复制Rack attack 配置
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -u git -H cp config/initializers/rack_attack.rb.example config/initializers/rack_attack.rb</span><br></pre></td></tr></table></figure></p>
<p>然后配置git全局配置
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sudo -u git -H git config --global user.name <span class="string">"GitLab"</span></span><br><span class="line">sudo -u git -H git config --global user.email <span class="string">"xiongneng@winhong.com"</span></span><br><span class="line">sudo -u git -H git config --global core.autocrlf input</span><br><span class="line"></span><br><span class="line"><span class="comment"># Configure Redis connection settings</span></span><br><span class="line">sudo -u git -H cp config/resque.yml.example config/resque.yml</span><br></pre></td></tr></table></figure></p>
<p>如果不使用Redis的默认端口，则需要配置
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -u git -H vim config/resque.yml</span><br></pre></td></tr></table></figure></p>
<p>注意：同时你还需要配置gitlab.yml和unicorn.rb</p>
<p>配置一下权限，如果这里repositories还不存在，那么等后面再来执行：
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo chmod 700 /home/git/gitlab/public/uploads</span><br><span class="line">sudo chmod -R ug+rwX,o-rwx /home/git/repositories/</span><br><span class="line">sudo chmod -R ug-s /home/git/repositories/</span><br><span class="line">sudo find /home/git/repositories/ -type d -print0 | sudo xargs -0 chmod g+s</span><br></pre></td></tr></table></figure></p>
<p>配置gitlab数据库
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -u git cp config/database.yml.mysql config/database.yml</span><br></pre></td></tr></table></figure></p>
<p>配置数据库的密码，修改为正确的用户名和密码，分别修改git用户和root用户
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo -u git -H vim config/database.yml</span><br><span class="line">sudo -u git -H chmod o-rwx config/database.yml</span><br></pre></td></tr></table></figure></p>
<p><em>安装Gems</em></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cd /home/git/gitlab</span><br><span class="line"># 修改为淘宝的ruby源</span><br><span class="line">vi Gemfile</span><br><span class="line"># 修改为：source &quot;https://ruby.taobao.org/&quot;</span><br><span class="line"># 下面这一步的时间会等很久</span><br><span class="line">sudo -u git -H bundle install --deployment --without development test postgres aws</span><br></pre></td></tr></table></figure>
<p><em>安装GitLab shell</em></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">su - git</span><br><span class="line">cd /home/git/gitlab</span><br><span class="line">ln -s /usr/local/bin/git /usr/bin/git</span><br><span class="line">bundle exec rake gitlab:shell:install[v$(cat GITLAB_SHELL_VERSION)] REDIS_URL=unix:/var/run/redis/redis.sock RAILS_ENV=production</span><br><span class="line">logout</span><br><span class="line"></span><br><span class="line"># 查看下gitlab-shell配置</span><br><span class="line">sudo -u git -H editor /home/git/gitlab-shell/config.yml</span><br></pre></td></tr></table></figure>
<p><em>安装 gitlab-workhorse</em></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">su - git</span><br><span class="line">cd /home/git/</span><br><span class="line">git clone https://gitlab.com/gitlab-org/gitlab-workhorse.git</span><br><span class="line">logout</span><br><span class="line"></span><br><span class="line">cd /home/git/gitlab-workhorse</span><br><span class="line">ln -s /usr/local/go/bin/go /usr/bin/go</span><br><span class="line">sudo -u git -H make</span><br></pre></td></tr></table></figure>
<p>初始化数据并且激活高级特性
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /home/git/gitlab/</span><br><span class="line">sudo -u git -H bundle exec rake gitlab:setup RAILS_ENV=production</span><br></pre></td></tr></table></figure></p>
<p>按yes来创建数据库，创建后管理员用户也会创建了，并且默认密码是空，第一次打开会让你新建密码。输出类似下面：
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Administrator account created:</span><br><span class="line"></span><br><span class="line">login:    root</span><br><span class="line">password: You&apos;ll be prompted to create one on your first visit.</span><br></pre></td></tr></table></figure></p>
<p><em>安装初始化脚本</em></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo cp /home/git/gitlab/lib/support/init.d/gitlab /etc/init.d/gitlab</span><br><span class="line">chmod +x /etc/init.d/gitlab</span><br><span class="line">chkconfig --add gitlab</span><br><span class="line">chkconfig gitlab on</span><br><span class="line">cp lib/support/logrotate/gitlab /etc/logrotate.d/gitlab</span><br></pre></td></tr></table></figure>
<p><em>检查应用状态</em></p>
<p>如果前面的gitlab正确配置好了，那么现在可以查看它的状态了：
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -u git -H bundle exec rake gitlab:env:info RAILS_ENV=production</span><br></pre></td></tr></table></figure></p>
<p>编译静态文件
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -u git -H bundle exec rake assets:precompile RAILS_ENV=production</span><br></pre></td></tr></table></figure></p>
<p><em>启动gitlab服务</em>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service gitlab start</span><br></pre></td></tr></table></figure></p>
<h2 id="配置web服务器"><a href="#配置web服务器" class="headerlink" title="配置web服务器"></a>配置web服务器</h2><p>官方推荐使用nginx服务器
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yum update</span><br><span class="line">yum -y install nginx</span><br><span class="line">chkconfig nginx on</span><br></pre></td></tr></table></figure></p>
<p>使用SSl
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp lib/support/nginx/gitlab-ssl /etc/nginx/conf.d/gitlab.conf</span><br></pre></td></tr></table></figure></p>
<p>不使用SSL
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp lib/support/nginx/gitlab /etc/nginx/conf.d/gitlab.conf</span><br></pre></td></tr></table></figure></p>
<p>我这里不使用SSL，编辑vim /etc/nginx/conf.d/gitlab.conf，将git.example.com替换成你的地址
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">listen 0.0.0.0:80;</span><br><span class="line">##listen [::]:80 default_server;</span><br><span class="line">server_name 192.168.217.161; ## Replace</span><br><span class="line">server_tokens off; ## Don&apos;t show</span><br><span class="line">location / &#123;</span><br><span class="line">    client_max_body_size 512m;</span><br></pre></td></tr></table></figure></p>
<p>另外还要加个gitlab的upstream，里面默认就一个gitlab-workhorse：
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">upstream gitlab &#123;</span><br><span class="line">  server unix:/home/git/gitlab/tmp/sockets/gitlab.socket fail_timeout=0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">upstream gitlab-workhorse &#123;</span><br><span class="line">  server unix:/home/git/gitlab/tmp/sockets/gitlab-workhorse.socket fail_timeout=0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>修改权限
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">usermod -a -G git nginx</span><br><span class="line">chmod g+rx /home/git/</span><br></pre></td></tr></table></figure></p>
<p>将selinux关闭，否则会出现 nginx 访问错误 (13: Permission denied)，HTTP显示502
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 最好去修改/etc/selinux/conf</span><br><span class="line"># 将SELINUX=enforcing 改为 SELINUX=disabled,重启机器即可</span><br><span class="line">setenforce 0 # 只是临时关闭，重启后问题仍然出现</span><br><span class="line">service nginx start</span><br><span class="line">shutdown -r now</span><br><span class="line">service gitlab restart</span><br></pre></td></tr></table></figure></p>
<p>测试下
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx -t</span><br></pre></td></tr></table></figure></p>
<h2 id="配置防火墙"><a href="#配置防火墙" class="headerlink" title="配置防火墙"></a>配置防火墙</h2><p>直接禁用防火墙最简单
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl stop firewalld</span><br><span class="line">systemctl mask firewalld</span><br></pre></td></tr></table></figure></p>
<p>设置开放端口到服务器外访问，这里以8008为例子，需要替换为真实的端口
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/sbin/iptables -I INPUT -p tcp --dport 8008 -j ACCEPT</span><br><span class="line">service iptables restart</span><br></pre></td></tr></table></figure></p>
<h2 id="最后检查"><a href="#最后检查" class="headerlink" title="最后检查"></a>最后检查</h2><p>为了确保所有流程都正确完成，执行下面的检查：
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /home/git/gitlab</span><br><span class="line">sudo -u git -H bundle <span class="built_in">exec</span> rake gitlab:check RAILS_ENV=production</span><br></pre></td></tr></table></figure></p>
<p>如果都是绿色的，表示安装成功。
如果出现类似表找不到的错误，那么就是前面的数据库初始化没成功，再执行一次：
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -u gitlab -H bundle exec rake db:migrate RAILS_ENV=production</span><br></pre></td></tr></table></figure></p>
<p>然后浏览器直接访问：<a href="http://192.168.217.161/" target="_blank" rel="external">http://192.168.217.161/</a></p>
<h2 id="Gitlab-备份"><a href="#Gitlab-备份" class="headerlink" title="Gitlab 备份"></a>Gitlab 备份</h2><p>官网的备份说明</p>
<p><a href="https://gitlab.com/gitlab-org/gitlab-ce/blob/master/doc/raketasks/backup_restore.md" target="_blank" rel="external">https://gitlab.com/gitlab-org/gitlab-ce/blob/master/doc/raketasks/backup_restore.md</a></p>
<p>查看备份设置
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /home/git/gitlab/config/gitlab.yml</span><br></pre></td></tr></table></figure></p>
<p>检查Backup Settings设置项。
默认情况下，备份文件是存放在/home/git/gitlab/tmp/backups/</p>
<p>执行备份
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo service gitlab stop # 先停止Gitlab，可以不暂停</span><br><span class="line">cd /home/git/gitlab/</span><br><span class="line">sudo -u git -H bundle exec rake gitlab:backup:create RAILS_ENV=production</span><br></pre></td></tr></table></figure></p>
<p>执行完成后，会在/home/git/gitlab/tmp/backups/目录下创建一个备份俄文件，
以时间戳_gitlab_backup命名如 1417040627_gitlab_backup.tar</p>
<p>重新启动
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo service gitlab start</span><br><span class="line">sudo service nginx restart</span><br></pre></td></tr></table></figure></p>
<p>还原
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">chmod o+wrx /home/git/.ssh/authorized_keys.lock</span><br><span class="line"># 需要使用 git 用户来执行，否则会没有权限操作 git 目录下的文件，timestamp_of_backup为时间戳如 1417040627</span><br><span class="line">sudo service gitlab stop</span><br><span class="line">cd /home/git/gitlab/</span><br><span class="line">sudo -u git -H bundle exec rake gitlab:backup:restore BACKUP=timestamp_of_backup RAILS_ENV=production</span><br></pre></td></tr></table></figure></p>
<p>如果是从全新部署的 gitlab 还原，需要执行这一步
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -u git -H bundle exec rake gitlab:satellites:create RAILS_ENV=production</span><br></pre></td></tr></table></figure></p>
<p>重启 gitlab
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo service gitlab start</span><br><span class="line">sudo service nginx restart</span><br><span class="line"></span><br><span class="line">sudo -u git -H bundle exec rake gitlab:check RAILS_ENV=production</span><br></pre></td></tr></table></figure></p>
<p>设置自动备份
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo service gitlab stop;</span><br><span class="line">cd /home/git/gitlab;</span><br><span class="line">sudo -u git -H editor config/gitlab.yml;</span><br><span class="line"># Enable keep_time in the backup section to automatically delete old backups</span><br></pre></td></tr></table></figure></p>
<p>keep_time参数默认是604800（单位是秒），因此会保留最近7天内的备份
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -u git crontab -e # Edit the crontab for the git user</span><br></pre></td></tr></table></figure></p>
<p>将如下内容添加到文件末尾
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 每天凌晨2点自动备份</span><br><span class="line">0 2 * * * cd /home/git/gitlab &amp;&amp; PATH=/usr/local/bin:/usr/bin:/bin bundle exec rake gitlab:backup:create RAILS_ENV=production CRON=1</span><br></pre></td></tr></table></figure></p>
<p>重新启动
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo service gitlab start;</span><br><span class="line">sudo service nginx restart;</span><br><span class="line">sudo -u git -H bundle exec rake gitlab:check RAILS_ENV=production;</span><br></pre></td></tr></table></figure></p>
<h2 id="忘记管理员密码"><a href="#忘记管理员密码" class="headerlink" title="忘记管理员密码"></a>忘记管理员密码</h2><p>Gitlab 服务器上使用
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># Gitlab 安装路径</span><br><span class="line">cd /home/git/gitlab</span><br><span class="line"># 进入Rails控制台</span><br><span class="line">sudo -u git -H bundle exec rails console production</span><br><span class="line"># 进入控制台，如果知道需要修改用户的邮箱，使用如下，直接修改</span><br><span class="line">user = User.find_by(email: &apos;admin@example.com&apos;)</span><br><span class="line">user.password = &apos;secret_password&apos;</span><br><span class="line">user.password_confirmation = &apos;secret_password&apos;</span><br><span class="line">user.save</span><br><span class="line"># 如果不知道具体邮箱，可以通过find来查找邮箱</span><br><span class="line">user = User.find(1)</span><br></pre></td></tr></table></figure></p>
<h2 id="FAQ"><a href="#FAQ" class="headerlink" title="FAQ"></a>FAQ</h2><ol>
<li>内网请使用SSH协议的地址来pull/push，profile settings中SSH Keys添加相应的pubkey</li>
<li>公网的话就使用https协议了，这个暂时还没研究</li>
<li>win7上面push的时候报了一个libcurl-4.dll找不到，去网上下载后放到C:\Windows\SysWOW64\下面</li>
</ol>
<h2 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h2><ul>
<li><a href="https://gitlab.com/help/install/installation.md" target="_blank" rel="external">https://gitlab.com/help/install/installation.md</a></li>
<li><a href="https://gitlab.com/gitlab-org/gitlab-recipes/tree/master/install/centos" target="_blank" rel="external">https://gitlab.com/gitlab-org/gitlab-recipes/tree/master/install/centos</a></li>
</ul>
</div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="http://yidao620c.github.io/2016/09/09/toolkit/gitlab.html" data-id="cixyqadmg00970or1stp6kim2" class="article-share-link">分享到</a><div class="tags"><a href="/tags/git/">git</a></div><div class="post-nav"><a href="/2016/09/16/toolkit/mysql-ha.html" class="pre">上一篇: centos7配置mysql主从复制</a><a href="/2016/09/05/python/jinja2.html" class="next">下一篇: jinja2模板</a></div><div data-thread-key="2016/09/09/toolkit/gitlab.html" data-title="centos7安装gitlab8.9" data-url="http://yidao620c.github.io/2016/09/09/toolkit/gitlab.html" class="ds-share flat"><div class="ds-share-inline"><ul class="ds-share-icons-16"><li data-toggle="ds-share-icons-more"><a href="javascript:void(0);" class="ds-more">分享到：</a></li><li><a href="javascript:void(0);" data-service="weibo" class="ds-weibo">微博</a></li><li><a href="javascript:void(0);" data-service="qzone" class="ds-qzone">QQ空间</a></li><li><a href="javascript:void(0);" data-service="qqt" class="ds-qqt">腾讯微博</a></li><li><a href="javascript:void(0);" data-service="wechat" class="ds-wechat">微信</a></li></ul><div class="ds-share-icons-more"></div></div></div><div data-thread-key="2016/09/09/toolkit/gitlab.html" data-title="centos7安装gitlab8.9" data-url="http://yidao620c.github.io/2016/09/09/toolkit/gitlab.html" data-author-key="1" class="ds-thread"></div></div></div></div><div class="pure-u-1-4"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="http://yidao620c.github.io"/></form></div><div class="widget"><div class="widget-title"><i class="fa myfa fa-folder-o"></i>分类</div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/java/">java</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/python/">python</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/toolkit/">toolkit</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/技术随笔/">技术随笔</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/朝花夕拾/">朝花夕拾</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/算法之美/">算法之美</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa myfa fa-star-o"></i>标签</div><div class="tagcloud"><a href="/tags/redis/" style="font-size: 15px;">redis</a> <a href="/tags/python/" style="font-size: 15px;">python</a> <a href="/tags/算法/" style="font-size: 15px;">算法</a> <a href="/tags/java/" style="font-size: 15px;">java</a> <a href="/tags/hadoop/" style="font-size: 15px;">hadoop</a> <a href="/tags/hexo/" style="font-size: 15px;">hexo</a> <a href="/tags/负载均衡/" style="font-size: 15px;">负载均衡</a> <a href="/tags/笑话/" style="font-size: 15px;">笑话</a> <a href="/tags/love/" style="font-size: 15px;">love</a> <a href="/tags/memcached/" style="font-size: 15px;">memcached</a> <a href="/tags/mqtt/" style="font-size: 15px;">mqtt</a> <a href="/tags/nginx/" style="font-size: 15px;">nginx</a> <a href="/tags/octopress/" style="font-size: 15px;">octopress</a> <a href="/tags/osgi/" style="font-size: 15px;">osgi</a> <a href="/tags/rabbitmq/" style="font-size: 15px;">rabbitmq</a> <a href="/tags/linux/" style="font-size: 15px;">linux</a> <a href="/tags/scrapy/" style="font-size: 15px;">scrapy</a> <a href="/tags/servlet/" style="font-size: 15px;">servlet</a> <a href="/tags/django/" style="font-size: 15px;">django</a> <a href="/tags/sitemesh/" style="font-size: 15px;">sitemesh</a> <a href="/tags/SQLAlchemy/" style="font-size: 15px;">SQLAlchemy</a> <a href="/tags/xpath/" style="font-size: 15px;">xpath</a> <a href="/tags/yaml/" style="font-size: 15px;">yaml</a> <a href="/tags/sed/" style="font-size: 15px;">sed</a> <a href="/tags/python核心/" style="font-size: 15px;">python核心</a> <a href="/tags/jinja2/" style="font-size: 15px;">jinja2</a> <a href="/tags/vagrant/" style="font-size: 15px;">vagrant</a> <a href="/tags/wsgi/" style="font-size: 15px;">wsgi</a> <a href="/tags/mysql/" style="font-size: 15px;">mysql</a> <a href="/tags/git/" style="font-size: 15px;">git</a> <a href="/tags/awk/" style="font-size: 15px;">awk</a></div></div><div class="widget"><div class="widget-title"><i class="fa myfa fa-file-o"></i>最新文章</div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2020/03/07/joke.html">开心一刻</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/22/linux/awk.html">awk命令笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/20/linux/sed.html">sed命令笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/16/toolkit/mysql-ha.html">centos7配置mysql主从复制</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/09/toolkit/gitlab.html">centos7安装gitlab8.9</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/05/python/jinja2.html">jinja2模板</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/02/python/vagrant.html">Vagrant创建虚拟化开发环境</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/30/love.html">临汾印象</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/26/python/pycharm-remote.html">使用PyCharm进行远程开发和调试</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/30/python/django-deploy.html">CentOS7上使用mod_wsgi部署Django</a></li></ul></div><div class="widget"><div class="comments-title"><i class="fa myfa fa-comment-o"></i>最近评论</div><div data-num-items="5" data-show-avatars="0" data-show-time="1" data-show-admin="0" data-excerpt-length="32" data-show-title="1" class="ds-recent-comments"></div></div><div class="widget"><div class="widget-title"><i class="fa myfa fa-external-link"></i>友情链接</div><ul></ul><a href="http://www.huxiu.com/index.php" title="虎嗅网" target="_blank">虎嗅网</a><ul></ul><a href="http://www.infoq.com/cn/" title="InfoQ" target="_blank">InfoQ</a><ul></ul><a href="http://blog.jobbole.com/" title="伯乐在线" target="_blank">伯乐在线</a><ul></ul><a href="http://www.cnblogs.com/" title="博客园" target="_blank">博客园</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <span>2015</span><span class="with-love"><i class="fa fa-heart"></i></span>熊能<br/>
由<a rel="nofollow" target="_blank" href="http://hexo.io/" class="footera">Hexo</a>强力驱动 | 主题<a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo" class="footera">maupassant-hexo</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="//cdn.bootcss.com/jquery/2.2.1/jquery.min.js"></script><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.0"><script>var duoshuoQuery = {short_name:'yidao620c'};
(function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0]
        || document.getElementsByTagName('body')[0]).appendChild(ds);
})();
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>